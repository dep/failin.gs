<fieldset id="signup_form" style="<%= 'display: none;' if @user.nil? || controller.is_a?(PagesController) %>">
  <% form_for @user, :url => account_path do |f| %>
    <%= f.hidden_field :invitation_email, value: params[:invited] %>

    <%= f.error_messages %>

    <%= f.label :login, "Username:" %>
    <%= f.text_field :login, maxlength: User::LOGIN_LENGTH.max %>
    <%= javascript_tag %{$("user_login").focus();} if params[:invited] || params[:promo_code] %>

    <% f.label :surname do %>
      Your <strong>real</strong> last name:
      (<%= link_to "Why we ask", "#", onclick: "$('box_important').appear(); return false;" %>):
    <% end %>
    <%= f.text_field :surname %>

    <%= f.label :email, "Email address:" %>
    <%= f.text_field :email, value: @user.email || params[:invited] %>

    <%= f.label :password, "Password:" %>
    <%= f.password_field :password %>

    <%= f.label :password_confirmation, "Twice to be sure:" %>
    <%= f.password_field :password_confirmation %>
    <div id="promo_wrapper">
      <%= f.label :promo_code, "Promo code?" %>
      <%= f.text_field :promo_code, value: @user.promo_code || params[:promo_code] %>
    </div>
    <p>By creating an account you agree to our very exciting <a href="/pages/terms">terms of use</a> and also agree to play nice.</p>
    <%= f.submit "Sign up!" %>
  <% end %>
  <script type="text/javascript">
    if ($('user_invitation_email').value)
      $('promo_wrapper').hide();
  </script>
</fieldset>
